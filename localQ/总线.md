[TOC]

<font face="STCAIYUN" size ="6">Author：DreamSeekerZD</font>

### 概述

为什么可以并行的传递很多个比特的信息❓

因为每个总线它里边可能会包含很多根信号线，如果想要并行传递32比特的数据，那么数据总线内部需要包含32根信号线。由于所有的硬件部件都是连在数据总线上的，故可通过传递高低电平信号，让所有的硬件部件都可以通过这个数据总线来接收CPU要发给他们的信号。

![image-20230508212613021](E:\每日三省吾身\imgs\image-20230508212613021.png)



如何解决多个设备争用总线的问题❓

总线仲裁和总线标准不考~



设备之间如何进行数据的传输❓

总线定时和操作





```
```

#### 🛫总线的特点

![image-20230508213347975](E:\每日三省吾身\imgs\image-20230508213347975.png)

为什么要采用总线❓

共享是指所有的这些硬件部件都是共享地来使用；如果多个部件都想要往总线上发送信息，那么显然他们需要分别在不同的时间内来使用这个总线。

#### 🛫总线特性

![image-20230508213824629](E:\每日三省吾身\imgs\image-20230508213824629.png)

传输方向体现在于：CPU可以通过地址总线给主存指明此次要读或者要写的地址应该是什么样的一个地址。那显然，这个地址总线的传输方向只能是由CPU传向主存或者CPU传到其他的呃硬件部件，比如说CPU传到硬盘。而不可能是主存把地址信息传给CPU。

#### 🛫总线的分类

![image-20230508213949555](E:\每日三省吾身\imgs\image-20230508213949555.png)

##### 🌏按数据传输格式

![image-20230508214749456](E:\每日三省吾身\imgs\image-20230508214749456.png)

串行意味着每次只能传一个比特数据，而并行意味着每次可以传多个比特数据。抗干扰能力强，就意味着呃，在长距离传输的时候，这个数据不容易发生跳变。**节省布线空间**，在计算机主板上，只需要用光刻机刻上一根线就可以了。

发送一组有意义的二进制信息是以一个字节或多个字节为单位的，但由于每次只能传送一个比特，因此存在拆卸和装配的过程。其它部件不一定能一个一个比特接收数据，故还需要串并行转换。

并行由于它们之间的距离比较近。因此，有可能会造成信息的干扰，很有可能会导致二进制信息位的跳变，故并行总线在发送数据的时候，电气特性会导致这个发送的频率是有上限的。

##### 🌏按总线功能连接的部件

**⭐系统总线**：

①对于数据总线，数据传输方向是双向的，若总线宽度和机器字长一致，CPU可以通过**一次的数据读入**。就可以直接取得CPU可以处理的多个数据。若和存储字长一致，意味着每一次的主存读或者写操作，只需要用数据**总线传一次**数据就可以

②地址总线的宽度，它的位数需要和我们的主存地址空间能保持一致，如果主存和IO设备采用统一编制的方式，IO设备的数量也会影响到地址总线应该设置的宽度。地址总线传递信息肯定都是单向的，一定是由CPU发送这个地址信号来指明他想要读或者写的这个设备或者。主存的地址是哪一个。

③对于单根的控制线来说。这个信号的传输方向是单向的，然而对于整个控制总线来说，它的传输方向既有可能是CPU向其他设备传输，也有可能是其他设备向CPU反馈

**注意数据通路和数据总线是有区别的**。数据通路是描述这个数据流经的路径，它是一种逻辑上的描述，而数据总线是承载这个数据流动的一个物理的媒介。地址总线也可以作为数据通路的一个物理媒介。

片内总线连接的是CPU内部的各个功能部件。系统总线连接的是一台计算机里边的各个功能部件，而通信总线是连接不同的计算机之间的一个总线。

```
```

#### 🛫系统总线的结构 

##### 🌏单总线

![image-20230509213129686](E:\每日三省吾身\imgs\image-20230509213129686.png)

各个部件对总线的使用应该是互斥的，**同一时刻只有一个功能部件能够获得这个系统总线的控制权**，因此会**导致它的带宽低**。就传输的速度慢。**并且不支持并发的传送**

**这地方并发的概念和操作系统里边的并发是有一点区别的**，这儿所谓的并发其实想表示的应该把它理解为是并行。就是说**同一时刻只能有两组部件之间正在传送数据，而不可能是多组部件之间同时通过这个总线来传递数据**。

虽然这个系统总线它可以支持很快的速度传输，当我们用快速的系统总线来让这些慢速的设备传送数据的时候。是不是就意味着**这个快速的系统总线，它的性能是被浪费的**，**所有的这些慢速设备都接在同一根快速的系统总线上，这种方式显然是不科学的**

```
```

##### 🌏双总线

![image-20230509213101789](E:\每日三省吾身\imgs\image-20230509213101789.png)

通道可以被视为低配版的CPU，**引入通道可以缓和CPU和各个IO设备之间的速度矛盾**，通道可以**对所有的IO设备进行统一的管理**。另一个方面，通道要管理这些IO设备，它也需要运行管理相关的呃代码程序，那通道要**运行的程序也是被存放在主存里边的**

可以**支持突发传送**：送出一个地址之后可以**收到多个地址连续的数据**，CPU指明一个地址之后，如果能从主存当中**连续读出**多个字的数据，系统的效率会相对较高。

```
```

##### 🌏三总线

![image-20230509213038103](E:\每日三省吾身\imgs\image-20230509213038103.png)

CPU不需要通过**慢速的IO总线**和磁盘机进行数据交互，而是把CPU需要的数据先从磁盘机通过dma总线读入主存，读入多个块，然后CPU再直接从快速的主存当中取走这些数据，这样可以**缓和CPU和磁盘之间的速度矛盾**。

慢速设备通过IO总线直接和Cpu相连，所以能更快地响应CPU的命令。

高速外部设备可更快地通过Dma总线和主存进行数据交互。

三个总线同一时刻只能有一个总线正在工作。所以这就导致了系统的整体工作效率会比较低

```
```

![image-20230509213354500](E:\每日三省吾身\imgs\image-20230509213354500.png)







### 总线的性能指标

![image-20230509215659440](E:\每日三省吾身\imgs\image-20230509215659440.png)

```
```

#### 🛫总线的传输周期(总线周期)

申请阶段：这个阶段要做的就是总线的仲裁

寻址阶段：两个设备要通过总线进行数据交互，**主设备**会通过地址总线把他想要读或者写的那个地址单元传递给**从设备**。

传输阶段：通过指明的地址，往这个**从设备**中读出或写入数据

经过一个总线周期之后就可以完成一组数据的传送，比如数据总线的宽度(总线宽度)为32个比特(**32 位(bit)总线**)。

```
```

#### 🛫总线时钟周期

![image-20230509214608825](E:\每日三省吾身\imgs\image-20230509214608825.png)

总线的时钟周期中，时钟信号由CPU发出，故其也**同为机器的时钟周期**，如果一个CPU的主频为3.0GHz，它**每秒钟会发出3.0G的时钟节拍信号**，而**每个节拍信号就是一个时钟周期**(**1s/3.0G**为时钟周期的长度)



**为什么一个总线时钟周期可包含多个总线周期**❓

因为在一个时钟周期内可能会**在上升沿和下降沿分别进行一次总线数据传输**，也就是说**一个时钟周期里边包含了两个总线周期**。

所以要清楚总线周期和时钟周期到底是什么样的一个对应关系。

```
注意事项
```

总线带宽指的是总线本身它所能达到的最高的传输速率，即每秒能传多少个比特,然而，在总线传输的这些信息当中，也许**并不是所有的信息位都是有效信息**。比如可能会加上一些校验位，或者增加一些什么开头的标志，或者结尾的标志

所以有的题目有可能会让我们**计算有效数据的传输率**。那么，当我们进行这样的计算的时候，就需要把什么校验位啊，什么开头位啊，结尾位啊这些附加融余的信息给删除。只计算我们实际传输的有效信息位

![image-20230509220554113](E:\每日三省吾身\imgs\image-20230509220554113.png)

一个时钟周期内，我们可以传两次数据，因此这四次的数据传输只需要消耗两个时钟周期

每秒钟包含了66m个时钟周期，所以每一个时钟周期的长度就应该是一秒除以66m。差不多就是15纳秒,所以完成这128位数据的写，至少需要花费三个时钟周期，每一个时钟周期15纳秒，那总共就是45纳秒的时间

```
串行总线与并行总线
```

各个信号线之间会有干扰，就有可能导致数据大量的出错，所以并行总线的工作频率是更低的，串行总线由于没有这种数据线之间的干扰.

所以串行总线和并行总线到底哪种更快呢？**如果工作频率相同**的时候，肯定串行总线的传输速度要更慢，每次只能传一个比特。但是由于实际当中并行总线的工作频率，它有一个瓶颈，不可能无限的提高，而串行总线要提高它的工作频率，相对来说要容易一些。

串行总线的这个传输速度是有可能超过并行总线的。

```
总线复用
```

用同一组线来分时的传输地址信息和数据信息。用更少的线来传输更多的数据，从而可以节省呃总线的这个布线空间，同时也可以节省硬件的成本

基于这种总线复用技术，如果CPU要往主存当中写入某一个数据，

那首先CPU要通过这个总线。发出地址信息指明我要写的地址在什么地方，然后主存接收到地址信息之后，接下来CPU在发出数据的信息。同样是通过这个总线传递给主存，然后主存再根据刚才记录下来的地址信息，把这次接收到的数据写入相应的地址。所以如果采用这种总线复用技术，那么显然**当我们要传递地址信息和数据信息的时候，至少都需要两个总线周期。需要进行两次数据的传送**。

```
信号线数
```

**信号线数**是指三个总线数的总和，而**信号线**指的就是。最小的那个物理的导线就只能传输一个比特的线



### 总线操作和定时

总线周期的四个阶段：

![image-20230509223104337](E:\每日三省吾身\imgs\image-20230509223104337.png)



#### 🛫同步定时方式 

![image-20230512200614786](E:\每日三省吾身\imgs\image-20230512200614786.png)

上升沿执行本时钟周期内应当执行的事务。同步定时方式意味着这个统一的时钟信号是固定的，即每一个总线传输周期只会给四个时钟信号，由于这个从设备它的速度比较慢，所以如果从设备跟不上这么快的节奏，那么是不是他们俩的这种呃数据通信就会出现问题

```
采用较短总线长度的理由
```

如果这个总线周期内传送的数据，执行过程中发生了某些错误，比如说二进制位的跳变，发生了某一些比特位的错误，那么对于同步通信方式，并不会留有时间的余地让主从双方来检测数据传送的有效；总线长度越短，意味着信息的传送会越稳定，出现信息错误的概率也会越小

```
所接部件的存取时间接近的理由
```

如果总线节奏搞得太快。那就会导致从设备跟不上，而如果说这个总线的统一节奏搞得太慢，又会导致快速的那个设备，它的速度是被浪费的。

```
```

#### 🛫异步定时方式

①当CPU作为主设备时，它的**请求信号就是地址、读命令**，这两个信号作为请求信号，是因为这两个信号足够指明它要读的是哪一个设备，要读的是什么数据。

②三种互锁方式：根据请求信号和应答信号的撤销是否会受对方制约，将互锁方式分类为，"不 半 全"互锁方式。

采用第一种不互锁的方式的特点是**速度最快**，但可靠性最差。因为主设备和从设备都不能保证对方收到信号之后，自己再把这个信号给撤销。

全互锁的方式的特点是速度最慢，但是可靠性最强。主设备只有获得回答信号之后才会撤销自己的请求。而从设备只有检测到主设备，把这个请求信号撤销，也就是保证主设备已经收到自己的回答信号之后，它才会把回答信号给撤销

```markdown
>为什么总线周期长度是可变的❓
>>只有主设备和从设备请求回答的这个呃动作完成之后。才意味着完成了一个总线周期，完成了一次总线的数据传输
```

#### 🛫半同步通信

相较于同步控制方式，半同步的通信方式会增加一个反馈信号，当这些从设备跟不上节奏时，它就会通过控制线路，给这个总线的控制器，进行一个反馈，让总线控制器等自己几个节拍(准备数据)。

结合了异步通信方式，总线控制器就可以根据这个反馈信号来动态地调节每个传输周期内包含的时钟周期数，所以半同步通信方式能够支持速度差异比较大的主设备和从设备之间进行的数据交互。

```
```

#### 🛫分离式通信

![image-20230512203922301](E:\每日三省吾身\imgs\image-20230512203922301.png)

```
工作原理
-把总线的传输周期切分为两个独立的子周期，第一个子周期就是主设备，申请占用总线，并且发出发出请求信号 (地址命令、读写命令),请求读或写某个从设备
```

①从设备也能够主动申请总线的控制权。

②采用同步通信的方式，主设备在规定的节拍内发出请求信号。但是它不需要等待对方，也就不需要等待从设备的一个回应。规定的节拍内发出请求，让规定的节拍内来释放总线的控制权



### (了解即可)总线标准

![image-20230512204409458](E:\每日三省吾身\imgs\image-20230512204409458.png)

记忆**局部总线和串并行总线**有哪些即可